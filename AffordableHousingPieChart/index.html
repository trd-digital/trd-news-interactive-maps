<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>How a LIHTC application comes together</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      color: #222;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      padding: 24px 24px 32px;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.35rem;
      font-weight: 700;
    }

    .subtitle {
      font-size: 1rem;
      color: #444;
      margin-bottom: 1.5rem;
      line-height: 1.45;
    }

    .chart-wrapper {
      position: relative;
      height: 500px;
    }

    .notes {
      margin-top: 1.5rem;
      font-size: 0.85rem;
      color: #555;
      line-height: 1.4;
    }

    @media (max-width: 600px) {
      .container {
        padding: 16px;
      }
      .chart-wrapper {
        height: 380px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>How a LIHTC application comes together</h1>

    <div class="subtitle">
      An $66 million affordable housing development in Agoura Hills, California is expected to cost about $800,000 per unit. Costs that can drive the price up include permitting costs, legal and consulting fees and steps taken to follow specific design standards.
    </div>

    <div class="chart-wrapper">
      <canvas id="costChart"></canvas>
    </div>

    <div class="notes">
      <strong>Notes:</strong>
      Hover over each slice to view the dollar amount and its percentage of the total project cost.
    </div>
  </div>

  <script>
    // ---- UPDATED DATA ----
    const labels = [
      "Reserves/Contingencies",
      "Interest and fees",
      "Non-construction costs",
      "Developer Overhead/Profit",
      "Pre-development costs",
      "Construction costs",
      "Land/Acquisition cost"
    ];

    const dataValues = [
      2994491,
      4536216,
      4666134,
      2500000,
      2600000,
      41724448,
      5856194
    ];

    // Format USD
    function formatCurrency(value) {
      return value.toLocaleString("en-US", {
        style: "currency",
        currency: "USD",
        maximumFractionDigits: 0
      });
    }

    const totalCost = dataValues.reduce((sum, v) => sum + v, 0);

    const ctx = document.getElementById("costChart").getContext("2d");

    const costChart = new Chart(ctx, {
      type: "pie",
      data: {
        labels: labels,
        datasets: [
          {
            data: dataValues,
            backgroundColor: [
              "#264653",
              "#2a9d8f",
              "#e9c46a",
              "#f4a261",
              "#e76f51",
              "#6d597a",
              "#43aa8b"
            ],
            borderColor: "#ffffff",
            borderWidth: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: "right",
            labels: {
              boxWidth: 16,
              padding: 12,
              font: { size: 12 }
            }
          },
          tooltip: {
            callbacks: {
              label: function (context) {
                const label = context.label || "";
                const value = context.raw || 0;
                const percentage = ((value / totalCost) * 100).toFixed(1);
                return `${label}: ${formatCurrency(value)} (${percentage}%)`;
              }
            }
          }
        }
      }
    });
  </script>
</body>
</html>
